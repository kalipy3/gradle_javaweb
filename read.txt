read.txt

:Author: kalipy
:Email: kalipy@debian
:Date: 2020-09-17 23:07

表单重复提交问题
    危害：
        1.数据库多次保存相同数据
        2.安全问题
        3.服务器性能
    Http无状态协议
    因为每次http请求过来都会创建一个新的链接TCP

    1.成功以后，直接刷新页面(每次刷新就是重复上一次请求)
        将转发改为重定向即可
    2.网速服务器性能,导致处理请求慢。用户狂点注册按钮刷新
        将提交按钮点击后设置为不可用,然后手动提交表单
    3.用户成功以后点击后退，再次提交(因为是从浏览器缓存里拿index.jsp，所以注册按钮会从变灰状态重新变回可以点击的状态)
        采用令牌机制(token)
        每次提交表单，带上令牌。服务器验证令牌，口令合法处理请求，口令不合法，打回

        解决思路：
            服务器中和页面有一个相同的令牌。页面提交的时候，带上令牌，服务器验证是否跟它一致。
            如果一致则处理请求，如果不一致则不处理请求


    注意：token机制同时解决了问题1 2 3


验证码：
    流程

                    0.生成验证码，使用
                    工具生成验证码
                    同时在session中
                    存入验证码内容
                    /
                   /
  1.页面(注册页面)------------------->  2.UserServlet
    输入其它信息               验证验证码是否正确(session("code")==pagecode)
    输入验证码(对照图片)                    /\
    code=xxx                               /  \
                                          /    \
                                         /      \
                                    保存用户    回到页面，提示验证码错误

    2.原理：
        和token机制一模一样
        在页面生成验证码图片-->给session中保存验证码实际的内容-->用户提交表单-->取出session中的内容以及页面带来的验证码进行匹配-->成功则提交-->是否重新回到注册页面

    验证码配置：
        web.xml中配置初始化属性
            kaptcha.textproducer.font.names
            验证码的字体
            默认 Arial,Courier

            kaptcha.textproducer.char.string
            验证码中使用的字符
            默认 adcde23456789gfynmpwx
            还支持中文,eg:
                <init-param>
                    <param-name>kaptcha.textproducer.char.string</param-name>
                    <param-value>你好大家</param-value>
                </init-param>

            kaptcha.textproducer.char.length
            验证码中的字符数量
            默认 5
